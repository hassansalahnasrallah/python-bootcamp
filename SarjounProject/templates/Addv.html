{%extends 'base.html'%}

{% block container%}
<form class="jumbotron" name="Add_Vacation" action="{% url 'save' %}" method="POST">
{% csrf_token%}
	<h3>Fill out the vacation details</h3>
	<label>Description</label>
	<input class="form-control" name="desc" value="{{ vacation.description }}" placeholder="Description" required />
	<label>From</label>
	<input class="form-control" type="text" name="date_from" value="{{ vacation.datefrom|date:'Y-m-d' }}" required   />
	<label>To</label>
	<input class="form-control" type="text" name="date_to" value="{{ vacation.dateto|date:'Y-m-d' }}"required  />
	<input type="hidden" name="vacation_id" value="{{vacation.id}}"/>
	<br>
	<button type="submit" id="save_vacation" class="btn btn-success" href="{% url 'vacation' %}"> Save </button>
	</form>
<script src="http://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<br><br>

<script>

$(function(){
	$("#save_vacation").click(function(){
		
		$.ajax({
			type:"POST",
			url:"{% url 'save' %}",
			data: {
				desc:$('input[name=desc]').val(),
				date_from:$('input[name=date_from]').val(),
				date_to:$('input[name=date_to]').val(),
				vacation_id:$('input[name=vacation_id]').val(),
				csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()
			},
			dataType:'json',
			success: function(){
				console.log(response)
				if(response.status=='OK'){
					alert("Save Success");
					var topic_id=response.payload.id
					$("input[name=vacation_id_id]").val(vacation__id)
				}else if(response.message=='VACATION_NAME_DUPLICATE'){
					alert("Vacation alraedy found");
				}else if (response.message=='MISSING_RQUIRED_PARAMETERS'){
					alert("You have a missing parameter");
					
				}
			},
			error: function(){
				alert("error in save")
			}
		});
		
	});
	
});
</script>

{% endblock%}